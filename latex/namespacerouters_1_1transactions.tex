\doxysection{routers.\+transactions Namespace Reference}
\hypertarget{namespacerouters_1_1transactions}{}\label{namespacerouters_1_1transactions}\index{routers.transactions@{routers.transactions}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacerouters_1_1transactions_a3070449d0e7b0e5026d313fb9b358820}{create\+\_\+transaction}} (Transaction\+Payload payload, Async\+Session session=Depends(get\+\_\+session))
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacerouters_1_1transactions_a7abbe11b24ecfa8e4e98544ad87d3d4d}{router}} = APIRouter(prefix="{}/transactions"{}, tags=\mbox{[}"{}transactions"{}\mbox{]})
\end{DoxyCompactItemize}


\label{doc-func-members}
\Hypertarget{namespacerouters_1_1transactions_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{namespacerouters_1_1transactions_a3070449d0e7b0e5026d313fb9b358820}\index{routers.transactions@{routers.transactions}!create\_transaction@{create\_transaction}}
\index{create\_transaction@{create\_transaction}!routers.transactions@{routers.transactions}}
\doxysubsubsection{\texorpdfstring{create\_transaction()}{create\_transaction()}}
{\footnotesize\ttfamily \label{namespacerouters_1_1transactions_a3070449d0e7b0e5026d313fb9b358820} 
routers.\+transactions.\+create\+\_\+transaction (\begin{DoxyParamCaption}\item[{Transaction\+Payload}]{payload}{, }\item[{Async\+Session }]{session}{ = {\ttfamily Depends(get\+\_\+session)}}\end{DoxyParamCaption})}

\begin{DoxyVerb}@brief Create a BUY or SELL transaction and update holdings atomically.

Acquires a row-level lock on the relevant holding to prevent race conditions.
Updates weighted average price on BUY and validates sufficient quantity on SELL.

@param payload TransactionPayload Incoming transaction details including user_id, portfolio_id, ticker_id, type, price_per_share, quantity, and timestamp.
@param session AsyncSession Database session provided by dependency injection.
@return dict JSON object containing the created transaction_id and status.
@throws HTTPException 404 if the user or portfolio does not exist.
@throws HTTPException 400 if attempting to sell without a holding or with insufficient quantity.
@throws HTTPException 500 if the transaction fails for any other reason.
\end{DoxyVerb}
 

\label{doc-var-members}
\Hypertarget{namespacerouters_1_1transactions_doc-var-members}
\doxysubsection{Variable Documentation}
\Hypertarget{namespacerouters_1_1transactions_a7abbe11b24ecfa8e4e98544ad87d3d4d}\index{routers.transactions@{routers.transactions}!router@{router}}
\index{router@{router}!routers.transactions@{routers.transactions}}
\doxysubsubsection{\texorpdfstring{router}{router}}
{\footnotesize\ttfamily \label{namespacerouters_1_1transactions_a7abbe11b24ecfa8e4e98544ad87d3d4d} 
routers.\+transactions.\+router = APIRouter(prefix="{}/transactions"{}, tags=\mbox{[}"{}transactions"{}\mbox{]})}

